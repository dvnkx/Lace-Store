{"ast":null,"code":"import _objectSpread from\"/Users/macair/Documents/Codding/Projects/Sneakers-store/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/Users/macair/Documents/Codding/Projects/Sneakers-store/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/macair/Documents/Codding/Projects/Sneakers-store/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/macair/Documents/Codding/Projects/Sneakers-store/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useReducer}from\"react\";import{useSelector}from\"react-redux\";import{useForm}from\"react-hook-form\";import{yupResolver}from\"@hookform/resolvers/yup\";import\"./styles.css\";import axios from\"../../../axios\";import{changePassordSchema}from\"../../../schemas\";import{togglePasswordReducer}from\"../../../helpers/PasswordReducer\";import{Buttons}from\"../index\";import{UserPassword}from\"../../forms/index\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var UserPasswordBlock=function UserPasswordBlock(_ref){var _errors$currentPasswo,_errors$currentPasswo2,_errors$newPassword,_errors$newPassword2;var setVisible=_ref.setVisible;var _useReducer=useReducer(togglePasswordReducer,{old:false,new:false}),_useReducer2=_slicedToArray(_useReducer,2),state=_useReducer2[0],dispatch=_useReducer2[1];var _useSelector=useSelector(function(state){return state.auth.data;}),_id=_useSelector._id;var _useForm=useForm({defaultValues:{currentPassword:\"\",newPassword:\"\"},resolver:yupResolver(changePassordSchema),mode:\"onChange\"}),register=_useForm.register,handleSubmit=_useForm.handleSubmit,_useForm$formState=_useForm.formState,errors=_useForm$formState.errors,isValid=_useForm$formState.isValid;var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(values){return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:_context.next=2;return axios.patch(\"/user/password:\".concat(_id),values);case 2:setVisible();case 3:case\"end\":return _context.stop();}},_callee);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit(onSubmit),className:\"password-data-form\",children:[/*#__PURE__*/_jsx(\"label\",{children:\"New password\"}),/*#__PURE__*/_jsx(UserPassword,_objectSpread(_objectSpread({},register(\"currentPassword\")),{},{error:Boolean((_errors$currentPasswo=errors.currentPassword)===null||_errors$currentPasswo===void 0?void 0:_errors$currentPasswo.message),errorMessage:(_errors$currentPasswo2=errors.currentPassword)===null||_errors$currentPasswo2===void 0?void 0:_errors$currentPasswo2.message,isVisible:state.old,setVisible:function setVisible(){return dispatch({type:\"old\"});},type:state.old?\"text\":\"password\"})),/*#__PURE__*/_jsx(\"label\",{children:\"Old password\"}),/*#__PURE__*/_jsx(UserPassword,_objectSpread(_objectSpread({},register(\"newPassword\")),{},{error:Boolean((_errors$newPassword=errors.newPassword)===null||_errors$newPassword===void 0?void 0:_errors$newPassword.message),errorMessage:(_errors$newPassword2=errors.newPassword)===null||_errors$newPassword2===void 0?void 0:_errors$newPassword2.message,isVisible:state.new,setVisible:function setVisible(){return dispatch({type:\"new\"});},type:state.new?\"text\":\"password\"})),/*#__PURE__*/_jsx(Buttons,{disabled:!isValid,setVisible:setVisible})]});};export default UserPasswordBlock;","map":{"version":3,"names":["React","useReducer","useSelector","useForm","yupResolver","axios","changePassordSchema","togglePasswordReducer","Buttons","UserPassword","jsx","_jsx","jsxs","_jsxs","UserPasswordBlock","_ref","_errors$currentPasswo","_errors$currentPasswo2","_errors$newPassword","_errors$newPassword2","setVisible","_useReducer","old","new","_useReducer2","_slicedToArray","state","dispatch","_useSelector","auth","data","_id","_useForm","defaultValues","currentPassword","newPassword","resolver","mode","register","handleSubmit","_useForm$formState","formState","errors","isValid","onSubmit","_ref2","_asyncToGenerator","_regeneratorRuntime","mark","_callee","values","wrap","_callee$","_context","prev","next","patch","concat","stop","_x","apply","arguments","className","children","_objectSpread","error","Boolean","message","errorMessage","isVisible","type","disabled"],"sources":["/Users/macair/Documents/Codding/Projects/Sneakers-store/client/src/components/ui/AccountComponents/UserPasswordBlock.jsx"],"sourcesContent":["import React, { useReducer } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { useForm } from \"react-hook-form\";\nimport { yupResolver } from \"@hookform/resolvers/yup\";\nimport \"./styles.css\";\n\nimport axios from \"../../../axios\";\nimport { changePassordSchema } from \"../../../schemas\";\nimport { togglePasswordReducer } from \"../../../helpers/PasswordReducer\";\n\nimport { Buttons } from \"../index\";\nimport { UserPassword } from \"../../forms/index\";\n\nconst UserPasswordBlock = ({ setVisible }) => {\n  const [state, dispatch] = useReducer(togglePasswordReducer, {\n    old: false,\n    new: false,\n  });\n\n  const { _id } = useSelector((state) => state.auth.data);\n\n  const {\n    register,\n    handleSubmit,\n    formState: { errors, isValid },\n  } = useForm({\n    defaultValues: {\n      currentPassword: \"\",\n      newPassword: \"\",\n    },\n    resolver: yupResolver(changePassordSchema),\n    mode: \"onChange\",\n  });\n\n  const onSubmit = async (values) => {\n    await axios.patch(`/user/password:${_id}`, values);\n\n    setVisible();\n  };\n\n  return (\n    <form onSubmit={handleSubmit(onSubmit)} className=\"password-data-form\">\n      <label>New password</label>\n      <UserPassword\n        {...register(\"currentPassword\")}\n        error={Boolean(errors.currentPassword?.message)}\n        errorMessage={errors.currentPassword?.message}\n        isVisible={state.old}\n        setVisible={() => dispatch({ type: \"old\" })}\n        type={state.old ? \"text\" : \"password\"}\n      />\n      <label>Old password</label>\n      <UserPassword\n        {...register(\"newPassword\")}\n        error={Boolean(errors.newPassword?.message)}\n        errorMessage={errors.newPassword?.message}\n        isVisible={state.new}\n        setVisible={() => dispatch({ type: \"new\" })}\n        type={state.new ? \"text\" : \"password\"}\n      />\n      <Buttons disabled={!isValid} setVisible={setVisible} />\n    </form>\n  );\n};\n\nexport default UserPasswordBlock;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}